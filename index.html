<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="theme-color" content="#1e1e3c">
  <title>Academia de Danza NH — Accesos</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icon-192.png">
  <link rel="stylesheet" href="styles.css">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="assets/icon-192.png" alt="icono">
      <h1>Academia NH • Accesos</h1>
    </div>
    <button id="installBtn" class="ghost-btn" hidden>Instalar</button>
  </header>

  <main id="app">
    <section id="mode-switch">
      <button class="mode-btn" data-mode="alumno">Modo Alumno</button>
      <button class="mode-btn" data-mode="admin">Modo Administrador</button>
    </section>

    <!-- MODO ALUMNO -->
    <section id="alumno" class="card hidden">
      <h2>Entrada de Alumno</h2>
      <p class="desc">Ingresa tu clave de 4 dígitos</p>

      <div class="pin-display" id="studentPinDisplay">
        <span>•</span><span>•</span><span>•</span><span>•</span>
      </div>

      <div class="keypad" data-target="student">
        <button>1</button><button>2</button><button>3</button>
        <button>4</button><button>5</button><button>6</button>
        <button>7</button><button>8</button><button>9</button>
        <button class="alt">←</button><button>0</button><button class="alt">⟲</button>
      </div>

      <button class="primary" id="studentEnter">Entrar</button>

      <div id="alumnoResult" class="result hidden">
        <div class="perfil">
          <img id="alumnoFoto" alt="Foto de perfil">
          <div>
            <h3 id="alumnoNombre">Alumno</h3>
            <p id="alumnoClases">Clases disponibles: —</p>
          </div>
        </div>
        <p id="alumnoMensaje"></p>
      </div>
    </section>

    <!-- MODO ADMIN -->
    <section id="admin" class="card hidden">
      <h2>Acceso Administrador</h2>
      <p class="desc">Ingresa tu código de 4 dígitos</p>

      <div class="pin-display" id="adminPinDisplay">
        <span>•</span><span>•</span><span>•</span><span>•</span>
      </div>

      <div class="keypad" data-target="admin">
        <button>1</button><button>2</button><button>3</button>
        <button>4</button><button>5</button><button>6</button>
        <button>7</button><button>8</button><button>9</button>
        <button class="alt">←</button><button>0</button><button class="alt">⟲</button>
      </div>

      <button class="primary" id="adminEnter">Entrar</button>

      <div id="adminPanel" class="admin hidden">
        <nav class="tabs">
          <button data-tab="tab-registro" class="active">Registrar/Editar</button>
          <button data-tab="tab-agendar">Agendar Clases</button>
          <button data-tab="tab-listado">Listado & Historial</button>
          <button data-tab="tab-ajustes">Ajustes</button>
        </nav>

        <section id="tab-registro" class="tab active">
          <h3>Alumno</h3>
          <form id="formAlumno">
            <label>Nombre completo
              <input type="text" id="alNombre" required minlength="3">
            </label>
            <label>PIN (4 dígitos únicos)
              <input type="text" id="alPin" pattern="\d{4}" maxlength="4" inputmode="numeric">
            </label>
            <label>Foto de perfil
              <input type="file" id="alFoto" accept="image/*">
            </label>
            <div class="actions">
              <button class="primary" type="submit">Guardar</button>
              <button class="danger" type="button" id="btnEliminarAlumno">Eliminar</button>
            </div>
          </form>
          <div class="helper">Tip: PIN y letras grandes para evitar zoom en iPad/iPhone.</div>
        </section>

        <section id="tab-agendar" class="tab">
          <h3>Agendar Clases</h3>
          <div class="row">
            <label>Alumno
              <select id="agAlumno"></select>
            </label>
            <label>Mes
              <input type="month" id="agMes">
            </label>
            <label>Paquete
              <select id="agPaquete">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="4" selected>4</option>
                <option value="6">6</option>
                <option value="8">8</option>
                <option value="10">10</option>
                <option value="12">12</option>
              </select>
            </label>
          </div>
          <div id="calendar" class="calendar"></div>
          <div class="actions">
            <button class="primary" id="btnGuardarCalendario">Guardar selección</button>
            <button id="btnMesAnterior">◀ Mes anterior</button>
            <button id="btnMesSiguiente">Mes siguiente ▶</button>
          </div>
          <p class="helper">Máximo 12 días por mes. Las clases que no se tomen en su día se perderán automáticamente.</p>
        </section>

        <section id="tab-listado" class="tab">
          <h3>Listado</h3>
          <table id="tablaAlumnos">
            <thead><tr><th>Nombre</th><th>PIN</th><th>Clases restantes</th><th>Vence</th><th>Acciones</th></tr></thead>
            <tbody></tbody>
          </table>
          <div id="historial" class="history"></div>
        </section>

        <section id="tab-ajustes" class="tab">
          <h3>Ajustes</h3>
          <label>PIN Administrador
            <input type="text" id="ajPinAdmin" pattern="\d{4}" maxlength="4" inputmode="numeric">
          </label>
          <div class="row">
            <label>Voz (Español)
              <select id="ajVoz"></select>
            </label>
            <button id="btnProbarVoz">Probar voz</button>
          </div>
          <div class="row">
            <button id="btnPermitirNotifs">Permitir notificaciones</button>
            <button id="btnBackup">Exportar copia</button>
            <label class="filelike">Importar copia<input type="file" id="inputRestore" accept="application/json"></label>
          </div>
          <p class="helper">La notificación “un día antes” depende del navegador. Siempre verás el aviso al abrir la app.</p>
        </section>
      </div>
    </section>
  </main>

  <footer class="foot">
    <small>v1.0 — PWA offline • © Academia de Danza NH</small>
  </footer>

  <audio id="beep" src="assets/beep.wav" preload="auto"></audio>
  <script src="app.js"></script>
</body>
</html>